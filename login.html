<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Register</title>
    <!-- Semantic UI -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
    <!-- CSS -->
    <link href="assets/css/style.css" type="text/css" rel="stylesheet">
    <!-- Firebase Reference -->
    <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase.js"></script>   
</head>

<body>
    <!-- NavBar -->
    <div class="ui secondary menu" id="menu">
        <a class="active item" href="index.html">
            <p class="navItem">Home</p>
        </a>
        <a class="item" href="login.html">
            <p class="navItem">Sign In</p>
        </a>
        <a class="item" href="#">
            <p class="navItem">About</p>
        </a>
        <a class="item" href="browse.html">
            <p class="navItem">Browse</p>
        </a>
        <a class="item" href="contactUs.html">
            <p class="navItem">Contact Us</p>
        </a>
        </div>
        <!-- NavBar End -->
    
    <!--Form to enter enter Username and Password-->
    <div class="ui mini form">
        <div class="two fields">
            <div class="field">
                <label>User Name:</label>
                <input placeholder="User Name" id="userName" type="text">
            </div>

            <div class="field">
                <label>Password:</label>
                <input placeholder="Password" id="password" type="text">
            </div>
        </div>

        <!--Working Sign Up and Log in buttons-->
        <div class="ui signUp button">Sign up</div>

        <div class="ui login button">Login</div>
    </div>

<!-- FIXME: script tag added for testing remotely in the HTML, move code to main javascript once working -->
<!--TODO: make sure to add firebase library to the header in our script tag-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.2/firebase.js"></script>

<script>
    // Initialize Firebase
    var config = {
        apiKey: "AIzaSyAX5YgDAquBM8CxrEckXe0MN3XWhWKjeHU",
        authDomain: "hopon-f4180.firebaseapp.com",
        databaseURL: "https://hopon-f4180.firebaseio.com",
        projectId: "hopon-f4180",
        storageBucket: "hopon-f4180.appspot.com",
        messagingSenderId: "176317052818"
    };
        
    firebase.initializeApp(config);

    //define the database variable and empty strings for new user information
    var database = firebase.database();
            
    var userName = "";
    var password = "";


    //event handler for login button
    $(".login").on("click", function(event){
        event.preventDefault();

        userName = $("#userName").val().trim();
        console.log(userName)

        password = $("#password").val().trim();
        console.log(password)

        database.ref("/users").once("value", function(snapshot){
            var snapShot = snapshot.val()

            for (var key in snapShot) {
                console.log(snapShot[key].username)
                // snapShot[key].password === password
                //create if/ else/ else if statements to match usernames to passwords
            };
        });
    });

    //event listner for Username and Password information     
    $(".signUp").on("click", function(event){
        event.preventDefault();

        //Clears extra space after entering user information
        userName = $("#userName").val().trim();
        console.log(userName)

        password = $("#password").val().trim();
        console.log(password)

        //Pushes into a user folder in firebase
        database.ref("/users").push({
            username: userName, 
            password: password
         });
        
        //Clears form after adding information to form
        $("#userName").val("");
        $("#password").val("");
    });
            

    database.ref().on("value", function(snapshot) {

        // Print the initial data to the console
        console.log(snapshot.val());

        // Log the value of the various properties
        console.log(snapshot.val().userName);
        console.log(snapshot.val().password);

        // If any errors are experienced, log them to console.
        }, function(errorObject) {

            console.log("The read failed: " + errorObject.code);
     });

    //function to append new information to user
    database.ref().on("child_added", function(childSnapShot) {
        console.log(childSnapShot.val());
        

        var newUser = childSnapShot.val().username;
        var newPassword = childSnapShot.val().password;
    });

    //Remain commented out, testing putting objects into a string and onceloop
    // database.ref('/users').on('value', function(snapshot) {
    //     console.log('snapshot --->', snapshot.val());

    //     var snapShot = snapshot.val()

    //     for (var key in snapShot) {
    //         console.log(snapShot[key].username)
    //         // snapShot[key].password === password
    //     }
    // });
        
    //Creates a unique user folder, commented out once added to firebase database otherwise it would make a new /users + nicole test every time
    // database.ref('/users').push({
    //     username : 'nicole',
    //     password : 'test'
    // });

</script> 

<!-- footer -->
<div class="ui inverted vertical footer segment">
    <div class="ui center aligned container">
        <div class="seven wide column">
            <i class="beer icon ui centered"></i>
            <!-- <i class="twitter icon ui centered"></i>
            <i class="github icon ui centered"></i>
            <i class="facebook icon ui centered"></i>
            <i class="linkedin icon ui centered"></i> -->
        </div>
        <div class="ui horizontal inverted small divided link list">
            <a class="item" href="#">Site Map</a>
            <a class="item" href="#">Contact Us</a>
            <a class="item" href="#">Terms and Conditions</a>
            <a class="item" href="#">Privacy Policy</a>
        </div>
    </div>
</div>
<!-- end footer -->

</body>
</html>